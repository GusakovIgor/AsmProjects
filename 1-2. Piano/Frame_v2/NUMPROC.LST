Turbo Assembler	 Version 4.1	    03/09/21 14:43:51	    Page 1
numproc.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     org 100h
      4
      5				     ; Constants ===========================
      6
      7	      =0005		     BASE_NAME_SIZE equ	5
      8	      =0014		     MAX_INP_LEN equ 20
      9
     10				     ;======================================
     11
     12
     13
     14	0100			     Start:
     15					     ;==================================================================
     16					     ; Requires: Input buffer with constant size MAX_INP_LEN (up to 254)
     17					     ;
     18					     ; Returns:	 Char buffer with beginnig at si + 1, with it's
     19					     ;		 length	in [si]
     20					     ;
     21					     ; Damages:	 ah, si, dx
     22					     ;==================================================================
     23					     global GetString
*Warning* numproc.asm(23) Global type doesn't match symbol type: GETSTRING
     24	0100				     GetString proc
     25
     26	0100  B4 0A				     mov ah, 0ah
     27	0102  BA 0137r				     mov dx, offset Input
     28	0105  8B F2				     mov si, dx
     29	0107  C6 04 14				     mov byte ptr [si],	MAX_INP_LEN
     30
     31	010A  CD 21				     int 21h
     32	010C  46				     inc si
     33	010D  C3			     ret
     34	010E				     endp
     35
     36
     37
     38					     ;==================================================================
     39					     ; Requires: pointer on buffer in si (where	si + 1 - beginning of the string
     40					     ;					   and [si]    - length	of string)
     41					     ;
     42					     ; Returns:	 number	from the buffer	in ax
     43					     ;
     44					     ; Damages:	 ax, bx, cx, dx
     45					     ;==================================================================
     46					     global ReadNumber
*Warning* numproc.asm(46) Global type doesn't match symbol type: READNUMBER
     47	010E				     ReadNumber	proc
     48
     49	010E  33 C0				     xor ax, ax
     50	0110  33 C9				     xor cx, cx
     51	0112  33 FF				     xor di, di
     52
     53	0114  8A 0C				     mov cl, [si]
     54	0116  8B D1				     mov dx, cx	     ; Сохраняем количество цифр
     55	0118  46				     inc si	     ; Переходим к буфферу
Turbo Assembler	 Version 4.1	    03/09/21 14:43:51	    Page 2
numproc.asm



     56	0119  FC				     cld
     57
     58	011A  80 2C 30			 store_nums: sub byte ptr [si],	'0'
     59	011D  AC				     lodsb
     60	011E  50				     push ax	     ; Пушим каждую цифру в стек
     61	011F  E2 F9				     loop store_nums
     62
     63	0121  8B CA				     mov cx, dx	     ; Возвращаем в cx кол-во цифр
     64	0123  BB 0001				     mov bx, 1	     ; Множитель для первой цифры
     65
     66	0126  58		       count_number: pop ax	     ; Считываем новую цифру из	стека
     67
     68	0127  F7 E3				     mul bx	     ; Умножаем	цифру на степень 10
     69	0129  03 F8				     add di, ax	     ; Прибавляем произведение к сохранённой сумме (будущему числу)
     70
     71	012B  B8 000A				     mov ax, 10	     ; Умножаем	bx на 10
     72	012E  F7 E3				     mul bx
     73	0130  8B D8				     mov bx, ax
     74
     75	0132  E2 F2				     loop count_number
     76
     77
     78	0134  8B C7			       quit: mov ax, di
     79
     80	0136  C3			     ret
     81	0137				     endp
     82
     83
     84
     85	0137  14*(??)		     Input:  db	MAX_INP_LEN dup	(?)
     86
     87				     end Start
Turbo Assembler	 Version 4.1	    03/09/21 14:43:51	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/09/21"
??FILENAME			  Text	 "numproc "
??TIME				  Text	 "14:43:51"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 NUMPROC
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BASE_NAME_SIZE			  Number 0005
COUNT_NUMBER			  Near	 DGROUP:0126
GETSTRING			  Near	 DGROUP:0100
INPUT				  Near	 DGROUP:0137
MAX_INP_LEN			  Number 0014
QUIT				  Near	 DGROUP:0134
READNUMBER			  Near	 DGROUP:010E
START				  Near	 DGROUP:0100
STORE_NUMS			  Near	 DGROUP:011A

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  014B Word	  Public  CODE
Turbo Assembler	 Version 4.1	    03/09/21 14:43:51	    Page 4
Error Summary



*Warning* numproc.asm(23) Global type doesn't match symbol type: GETSTRING
*Warning* numproc.asm(46) Global type doesn't match symbol type: READNUMBER
