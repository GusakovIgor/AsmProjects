Turbo Assembler	 Version 4.1	    02/26/21 03:47:48	    Page 1
clearf~1.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     org 100h
      5
      6				     ; Constants ===========================
      7
      8	      =000A		     x1	= 10
      9	      =0046		     x2	= 70
     10
     11	      =000A		     y1	= 10
     12	      =0014		     y2	= 20
     13
     14	      =0654		     lu_coord =	(80 * y1 + x1) * 2
     15	      =0C94		     ld_coord =	(80 * y2 + x1) * 2
     16	      =06CC		     ru_coord =	(80 * y1 + x2) * 2
     17	      =0D0C		     rd_coord =	(80 * y2 + x2) * 2
     18
     19
     20	      =B800		     videomem =	0b800h
     21
     22	      =00BA		     vert_side	= 0bah	     ; vertical	side
     23	      =00CD		     horiz_side	= 0cdh	     ; horizontal side
     24
     25	      =00C9		     lu_corn = 0c9h  ; left-up
     26	      =00C8		     ld_corn = 0c8h  ; left-down
     27	      =00BB		     ru_corn = 0bbh  ; right-up
     28	      =00BC		     rd_corn = 0bch  ; right-down
     29
     30	      =0020		     space = 20h     ; free space
     31
     32	      =00B0		     shadow_30 = 0b0h	     ; 30 %
     33	      =00B1		     shadow_50 = 0b1h	     ; 50 %
     34	      =00B2		     shadow_70 = 0b2h	     ; 70 %
     35
     36				     ;======================================
     37
     38	0100			     Start:
     39	0100  E8 001F			     call DrawFrame
     40	0103  B8 4C00			     mov ax, 4c00h
     41	0106  CD 21			     int 21h
     42
     43					     ;========================================
     44					     ; Requires: defined x1, x2, y1, y2
     45					     ;
     46					     ; Returns:	 ----
     47					     ;
     48					     ; Damages:	 ax, bx, cx, es, di
     49					     ;========================================
     50	0108				     ClearFrame	proc
     51	0108  BF 0654				     mov di, lu_coord	     ; Coordinates of start
     52
     53	010B  B4 10				     mov ah, 10h     ; Black background
     54	010D  B0 20				     mov al, 20h     ; Space symbol
     55
     56	010F  B9 000A				     mov cx, y2	- y1
     57
Turbo Assembler	 Version 4.1	    02/26/21 03:47:48	    Page 2
clearf~1.asm



     58	0112					     clear:
     59	0112  8B D9					     mov bx, cx
     60	0114  B9 003C					     mov cx, x2	- x1
     61
     62	0117						     clear_line:
     63	0117  AB						     stosw	     ; mov es:[di], ax / inc di
     64	0118  E2 FD						     loop clear_line
     65
     66	011A  83 C7 28					     add di, (80 - (x2 - x1)) *	2
     67
     68	011D  8B CB					     mov cx, bx
     69	011F  E2 F1					     loop clear
     70
     71	0121  C3			     ret
     72	0122				     endp
     73
     74
     75
     76					     ;========================================
     77					     ; Requires: defined x1, x2, y1, y2
     78					     ;
     79					     ; Returns:	 ----
     80					     ;
     81					     ; Damages:	 ax, bx, cx, es, di
     82					     ;========================================
     83	0122				     DrawFrame proc
     84	0122  BB B800				     mov bx, videomem
     85	0125  8E C3				     mov es, bx			     ; Jump to videosegment
     86
     87	0127  E8 FFDE				     call ClearFrame
     88	012A  E8 0001				     call DrawBorders
     89
     90	012D  C3			     ret
     91	012E				     endp
     92
     93
     94
     95					     ;========================================
     96					     ; Requires: defined x1, x2, y1, y2
     97					     ;
     98					     ; Returns:	 ----
     99					     ;
    100					     ; Damages:	 ax, bx, cx, es, di
    101					     ;========================================
    102	012E				     DrawBorders proc
    103	012E  B4 18				     mov ah, 18h     ; Grey on Black background
    104
    105	0130  BF 0654				     mov di, lu_coord
    106	0133  B0 C9				     mov al, lu_corn
    107	0135  AB				     stosw
    108	0136  E8 002A				     call DrawHorizontalBorder
    109
    110	0139  BF 0654				     mov di, lu_coord
    111	013C  81 C7 00A0			     add di, 80*2
    112	0140  E8 0029				     call DrawVerticalBorder
    113
    114	0143  BF 0C94				     mov di, ld_coord
Turbo Assembler	 Version 4.1	    02/26/21 03:47:48	    Page 3
clearf~1.asm



    115	0146  B0 C8				     mov al, ld_corn
    116	0148  AB				     stosw
    117	0149  E8 0017				     call DrawHorizontalBorder
    118
    119	014C  BF 06CC				     mov di, ru_coord
    120	014F  81 C7 00A0			     add di, 80*2
    121	0153  E8 0016				     call DrawVerticalBorder
    122
    123	0156  BF 06CC				     mov di, ru_coord
    124	0159  B0 BB				     mov al, ru_corn
    125	015B  AB				     stosw
    126
    127	015C  BF 0D0C				     mov di, rd_coord
    128	015F  B0 BC				     mov al, rd_corn
    129	0161  AB				     stosw
    130
    131	0162  C3			     ret
    132	0163				     endp
    133
    134
    135
    136					     ;========================================
    137					     ; Requires: defined x1, x2, y1, y2
    138					     ;
    139					     ; Returns:	 ----
    140					     ;
    141					     ; Damages:	 al, cx, di
    142					     ;========================================
    143	0163				     DrawHorizontalBorder proc
    144	0163  B9 003B				     mov cx, x2	- x1 - 1
    145	0166  B0 CD				     mov al, horiz_side
    146
    147	0168				     h_symb:
    148	0168  AB				     stosw
    149	0169  E2 FD				     loop h_symb
    150
    151	016B  C3			     ret
    152	016C				     endp
    153
    154
    155
    156					     ;========================================
    157					     ; Requires: defined x1, x2, y1, y2
    158					     ;
    159					     ; Returns:	 ----
    160					     ;
    161					     ; Damages:	 al, cx, di
    162					     ;========================================
    163	016C				     DrawVerticalBorder	proc
    164	016C  B9 0009				     mov cx, y2	- y1 - 1
    165	016F  B0 BA				     mov al, vert_side
    166
    167	0171				     v_symb:
    168	0171  26: 89 05				     mov es:[di], ax
    169	0174  81 C7 00A0			     add di, 80*2
    170	0178  E2 F7				     loop v_symb
    171
Turbo Assembler	 Version 4.1	    02/26/21 03:47:48	    Page 4
clearf~1.asm



    172	017A  C3			     ret
    173	017B				     endp
    174
    175
    176
    177				     end Start
Turbo Assembler	 Version 4.1	    02/26/21 03:47:48	    Page 5
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/26/21"
??FILENAME			  Text	 "clearf~1"
??TIME				  Text	 "03:47:48"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 CLEARF~1
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
CLEAR				  Near	 DGROUP:0112
CLEARFRAME			  Near	 DGROUP:0108
CLEAR_LINE			  Near	 DGROUP:0117
DRAWBORDERS			  Near	 DGROUP:012E
DRAWFRAME			  Near	 DGROUP:0122
DRAWHORIZONTALBORDER		  Near	 DGROUP:0163
DRAWVERTICALBORDER		  Near	 DGROUP:016C
HORIZ_SIDE			  Number 00CD
H_SYMB				  Near	 DGROUP:0168
LD_COORD			  Number 0C94
LD_CORN				  Number 00C8
LU_COORD			  Number 0654
LU_CORN				  Number 00C9
RD_COORD			  Number 0D0C
RD_CORN				  Number 00BC
RU_COORD			  Number 06CC
RU_CORN				  Number 00BB
SHADOW_30			  Number 00B0
SHADOW_50			  Number 00B1
SHADOW_70			  Number 00B2
SPACE				  Number 0020
START				  Near	 DGROUP:0100
VERT_SIDE			  Number 00BA
VIDEOMEM			  Number B800
V_SYMB				  Near	 DGROUP:0171
X1				  Number 000A
X2				  Number 0046
Y1				  Number 000A
Y2				  Number 0014

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  017B Word	  Public  CODE
